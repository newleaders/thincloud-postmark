{"name":"Thincloud Postmark","tagline":"Generator for Postmark configuration in Rails 3 apps.","body":"[![Gem Version](https://badge.fury.io/rb/thincloud-postmark.svg)](http://badge.fury.io/rb/thincloud-postmark)\r\n[![Build Status](https://travis-ci.org/newleaders/thincloud-postmark.svg?branch=master)](https://travis-ci.org/newleaders/thincloud-postmark)\r\n[![Code Climate](https://codeclimate.com/github/newleaders/thincloud-postmark.png)](https://codeclimate.com/github/newleaders/thincloud-postmark)\r\n[![Test Coverage](https://codeclimate.com/github/newleaders/thincloud-postmark/coverage.png)](https://codeclimate.com/github/newleaders/thincloud-postmark)\r\n\r\n## Description\r\n\r\nRails Engine to provide [Postmark](http://postmarkapp.com) configuration for Thincloud applications.\r\n\r\nThe Thincloud::Postmark engine:\r\n\r\n* Manages all of the `Postmark` dependencies for your application\r\n* Optionally registers a `Mail` interceptor\r\n\r\n## Requirements\r\n\r\nThis gem requires Rails 3.2+ and has been tested on the following versions:\r\n\r\n* 3.2\r\n\r\nThis gem has been tested against the following Ruby versions:\r\n\r\n* 1.9.3\r\n* 2.0.0\r\n* 2.1.2\r\n\r\n\r\n## Installation\r\n\r\nAdd this line to your application's Gemfile:\r\n\r\n```ruby\r\ngem \"thincloud-postmark\"\r\n```\r\n\r\n* Run `bundle`\r\n\r\nOr install it yourself as:\r\n\r\n```\r\n$ gem install thincloud-postmark\r\n```\r\n\r\n## Usage\r\n\r\nThincloud::Postmark is only enabled for environments included in the `environments` array. For instance, to use `Postmark` in development and staging the list would look like this:\r\n\r\n```ruby\r\n[:development, :staging]\r\n```\r\n\r\nThe different configuration options and detailed below.\r\n\r\n### Configuration\r\n\r\nThincloud::Postmark configuration options are available to customize the engine behavior. Available options and their default values:\r\n\r\n```ruby\r\n# Rails environment(s) that should use the `postmark` delivery method.\r\nenvironments              = []\r\napi_key                   = \"POSTMARK_API_TEST\"\r\ninterceptor_to            = nil\r\ninterceptor_cc            = nil\r\ninterceptor_bcc           = nil\r\n\r\n# Rails environment(s) that should have mail intercepted.\r\ninterceptor_environments  = []\r\n```\r\n\r\n_Note: Don't forget to set the `default_url_options`_\r\n\r\n```ruby\r\nconfig.action_mailer.default_url_options = { host: \"mydomain.com\" }\r\n```\r\n\r\n#### Environment Variables\r\n\r\nSeveral of the options will use environment variables when found.\r\n\r\n```ruby\r\napi_key          # ENV[\"POSTMARK_API_KEY\"]\r\nsecure           # ENV[\"POSTMARK_SECURE\"]\r\ninterceptor_to   # ENV[\"THINCLOUD_INTERCEPTOR_TO\"]\r\ninterceptor_cc   # ENV[\"THINCLOUD_INTERCEPTOR_CC\"]\r\ninterceptor_bcc  # ENV[\"THINCLOUD_INTERCEPTOR_BCC\"]\r\n```\r\n\r\n#### Configuration Block\r\n\r\nThe `Thincloud::Postmark` module accepts a `configure` block that takes the same options listed above. This block can be put into an initializer or inside of a `config\\environments` file.\r\n\r\n```ruby\r\nThincloud::Postmark.configure do |config|\r\n  config.environments   = [:development, :production]\r\n  config.api_key        = \"MY_API_KEY\"\r\n  config.secure         = true\r\n  config.interceptor_to = \"keymaster@zuul.com\"\r\n  config.interceptor_cc = \"gatekeeper@zuul.com\"\r\n  config.interceptor_environments = [:test, :development]\r\n  # ...\r\nend\r\n```\r\n\r\n#### Rails Configuration\r\n\r\nYou can also access the configuration via the Rails configuration object. In fact, the engine uses the Rails config as storage when the block syntax is used. The `Thincloud::Postmark::Configuration` object is made available under `config.thincloud.postmark`. You can access this configuration in `config/application.rb` or in your `config/environments` files.\r\n\r\n```ruby\r\n#...\r\nconfig.thincloud.postmark.environments = [:development, :production]\r\nconfig.thincloud.postmark.api_key = \"MY_API_KEY\"\r\nconfig.thincloud.postmark.secure  = false\r\nconfig.thincloud.postmark.interceptor_environments = [:staging]\r\n#...\r\n```\r\n\r\n_Note: Configuration values take precendence over environment variables._\r\n\r\n#### Default Interceptor\r\n\r\nThe default interceptor is registered for environments included in the `interceptor_environments` array. It replaces the recipients with those contained in the configuration and replaces the subject of outgoing email with the original `to` combined with the original `subject`.\r\n\r\n```ruby\r\nclass Thincloud::Postmark::Interceptor\r\n  # ...\r\n  def self.delivering_email(message)\r\n    message.subject = \"#{message.to} #{message.subject}\"\r\n    message.to      = self.to\r\n    message.cc      = self.cc\r\n    message.bcc     = self.bcc\r\n    message\r\n  end\r\nend\r\n```\r\n\r\n#### Overriding the Interceptor\r\n\r\nYou may find that the default Interceptor does not meet your requirements. In that case you can easily create your own and prevent the default from being registered.\r\n\r\n* Disable the default interceptor\r\n\r\n```ruby\r\ninterceptor_environments = []\r\n```\r\n\r\n* Create your interceptor\r\n\r\n```ruby\r\n# Public: Mail Interceptor to use when overriding defaults\r\nclass MailInterceptor\r\n  def self.delivering_email(message)\r\n    message.subject = \"#{message.to} #{message.subject}\"\r\n    message.to      = \"#{ENV[\"USER\"]}@localhost\"\r\n    message.cc      = nil\r\n    message.bcc     = nil\r\n  end\r\nend\r\n```\r\n\r\n* Register your interceptor in an initializer\r\n\r\n```ruby\r\nrequire \"mail_interceptor\"\r\n\r\nMail.register_interceptor(MailInterceptor) unless Rails.env.production?\r\n```\r\n\r\n## Contributing\r\n\r\n1. [Fork it](https://github.com/newleaders/thincloud-postmark/fork_select)\r\n2. Create your feature branch (`git checkout -b my-new-feature`)\r\n3. Commit your changes (`git commit -am 'Added some feature'`)\r\n4. Push to the branch (`git push origin my-new-feature`)\r\n5. [Create a Pull Request](https://github.com/newleaders/thincloud-postmark/pull/new)\r\n\r\n\r\n## License\r\n\r\n* Freely distributable and licensed under the [MIT license](http://newleaders.mit-license.org/2012-2014/license.html).\r\n* Copyright (c) 2012-2014 New Leaders ([opensource@newleaders.com](opensource@newleaders.com))\r\n* [https://newleaders.com](https://newleaders.com)\r\n","google":"UA-1755363-18","note":"Don't delete this file! It's used internally to help with page regeneration."}